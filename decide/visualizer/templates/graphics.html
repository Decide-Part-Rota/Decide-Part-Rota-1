{% load static %}
<html lang="es-ES">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Graphics and Statistic</title>
    <link type="text/css" rel="stylesheet"
         href="https://unpkg.com/bootstrap-vue@latest/dist/bootstrap-vue.css" />
    <link type="text/css" rel="stylesheet" href="{% static 'css/graphics.css' %}" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
</head>
<body>
    <header>
        <div class="wrapper">
            <div class="logo">Votaciones para '{{votacion.name}}'</div>
        </div>
    </header>
    <div class="box-orange">   
        <canvas id="grafica" width="300" height="150"></canvas>
        <script>
            const $grafica = document.querySelector("#grafica");
            const color = ['rgb(69,177,223)', 'rgb(99,201,122)', 'rgb(203,82,82)', 'rgb(229,224,88)', 'rgb(54, 162, 235)'];
            const etiquetas = [{% for opt in procesado %} '{{opt.option}}', {% endfor %}]
            const datosVotacionBars = {
                label: "Votaciones para esta opción",
                data: [{% for opt in procesado %} {{opt.postproc}}, {% endfor %}],
                backgroundColor: color, 
                borderWidth: 1,
            };
            new Chart($grafica, {
                type: 'bar',
                data: {
                    labels: etiquetas,
                    datasets: [
                        datosVotacionBars,
                    ]
                },
                options: {
                    maintainAspectRatio: false,
                    scales: {
                        yAxes: [{
                            ticks: {
                                beginAtZero: true
                            }
                        }],
                    },
                }
            });
         </script>
    </div> 
    <div class="box-blue">
         <canvas id="grafic" width="300" height="150"></canvas>
         <script>
             const $graf = document.querySelector("#grafic");
             const eti = [{% for opt in procesado %} '{{opt.option}}', {% endfor %}]
             const colors = ['rgb(69,177,223)', 'rgb(99,201,122)', 'rgb(203,82,82)', 'rgb(229,224,88)', 'rgb(54, 162, 235)'];
             const datosVotacionLin = {
                 label: "Votaciones para esta opción",
                 data: [{% for opt in procesado %} {{opt.postproc}}, {% endfor %}],
                 backgroundColor: colors, 
                 borderWidth: 1,
             };
             new Chart($graf, {
                 type: 'pie',
                 data: {
                     labels: eti,
                     datasets: [
                         datosVotacionLin,
                     ]
                 },
                 options: {
                    maintainAspectRatio: false
                 }
             });
          </script>
    </div>
    <div class="tarjeta">
        <h1 class="titulo">Estadísticas para esta votación</h1>
        <div class="cuerpo">
            <div class="letras">
                <div id="winner">
                    El voto ganador es "{{ winner.option }}" <br>
                </div>
                <div id="loser">
                    El voto perdedor es "{{ loser.option }}" <br>
                </div>
                <strong>Porcentajes:</strong> <br>
                {% for opt, p in porcentages %}
                La opción "{{ opt.option }}" fue votada un {{ p }} % <br>
                {% endfor %}
            </div>
        </div>
    </div>
    
</body>
</html>